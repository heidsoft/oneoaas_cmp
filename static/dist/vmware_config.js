var VCenterConfig=function(e,t){return{accountTable:null,selectedRows:[],init:function(){var t={search:"搜索：",lengthMenu:"每页显示 _MENU_ 记录",zeroRecords:"没找到相应的数据！",info:"分页 _PAGE_ / _PAGES_",infoEmpty:"暂无数据！",infoFiltered:"(从 _MAX_ 条数据中搜索)",paginate:{first:"<<",last:">>",previous:"上一页",next:"下一页"}},c=e("#vcenter_config_record").DataTable({paging:!0,ordering:!1,info:!1,searching:!1,pageLength:5,lengthChange:!1,language:t,sLoadingRecords:!0,ajax:{url:site_url+"vmware/api/getVcenterAccountList"},columnDefs:[{targets:0,className:"dt-head-center dt-body-center",checkboxes:{selectRow:!0}}],select:{style:"multi"},columns:[{data:"id"},{title:"账号名称",data:"account_name"},{title:"云厂商",data:"cloud_provider"},{title:"操作",data:"id",render:function(e,t,c,n){var o='<button class="btn btn-xs btn-info ml10" onclick="VCenterConfig.syncVCenterAccount('+e+')"><i class="fa fa-history mr5"></i>同步</button>';return o+='<button class="btn btn-xs btn-info ml10" onclick="VCenterConfig.showAccountDetail('+n.row+')"><i class="mr5">…</i>详情</button>'}}]});return this.accountTable=c,c},createVCenterAccount:function(){var c=e("#vcenter_account_name").val(),n=e("#vcenter_account_password").val(),o=e("#vcenter_host").val(),a=e("#vcenter_version .select2_box").select2("val"),r=e("#vcenter_port").val(),l=e("#vmware_form");""!==c&&""!==n&&""!==o&&""!==r&&(""!==a?e.ajax({url:site_url+"vmware/api/createVCenterAccount",type:"post",dataType:"json",data:{cloudProvider:"vmware",accountName:c,accountPassword:n,vcenterHost:o,vcenterPort:r,vcenterVersion:a},success:function(c){t.success(c.message),VCenterConfig.accountTable.ajax.reload(null,!1),l.trigger("reset"),e("#vcenter_version .select2_box").select2("val","")}}):t.warning("版本不能为空"))},createQcloudAccount:function(){var c=e("#qcloud_account_name").val(),n=e("#qcloud_secret_id").val(),o=e("#qcloud_secret_key").val(),a=e("#qcloud_form");""!==c&&""!==n&&""!==o&&e.ajax({url:site_url+"vmware/api/createVCenterAccount",type:"post",dataType:"json",data:{cloudProvider:"qcloud",accountName:c,cloudPublicKey:n,cloudPrivateKey:o},success:function(e){t.success(e.message),VCenterConfig.accountTable.ajax.reload(null,!1),a.trigger("reset")}})},createUcloudAccount:function(){var c=e("#ucloud_account_name").val(),n=e("#ucloud_public_key").val(),o=e("#ucloud_private_key").val(),a=e("#ucloud_project_id").val(),r=e("#ucloud_region .select2_box").select2("val"),l=e("#ucloud_form");""!==c&&""!==n&&""!==o&&""!==a&&(""!==r?e.ajax({url:site_url+"vmware/api/createVCenterAccount",type:"post",dataType:"json",data:{cloudProvider:"ucloud",accountName:c,cloudPublicKey:n,cloudPrivateKey:o,projectId:a,cloudRegion:r},success:function(c){t.success(c.message),VCenterConfig.accountTable.ajax.reload(null,!1),l.trigger("reset"),e("#ucloud_region .select2_box").select2("val","")},error:function(e,t,c){console.log(e),console.log(t),console.log(c)}}):t.warning("区域不能为空"))},syncVCenterAccount:function(c,n){var o=dialog({cancel:!1,padding:0,width:500,content:'<div id="progressbar"></div>'});e("#progressbar").progressbar({value:!1}),o.showModal(),e.ajax({url:site_url+"vmware/api/syncCloudAccount",type:"post",dataType:"json",data:{id:c},success:function(e){o.remove(),e.result?t.success(e.message):t.error(e.message)}})},beforeAction:function(){var c=this.accountTable.column(0).checkboxes.selected();if(void 0===c||0===c.length)return t.warning("请选择账号资源"),!1;var n=this.selectedRows="";return e.each(c,function(e,t){n+=t+","}),this.selectedRows=n,!0},deleteAccount:function(){this.beforeAction()&&dialog({width:260,title:"提示",content:"确认删除？",okValue:"确定",ok:function(){e.ajax({url:site_url+"vmware/api/deleteAccount",type:"post",dataType:"json",data:{id:VCenterConfig.selectedRows},success:function(e){t.success(e.message),VCenterConfig.accountTable.ajax.reload(null,!1)}})},cancelValue:"取消",cancel:function(){},onshow:function(){}}).show()},desctroyAccount:function(){t.warning("蓝鲸社区版暂不支持该功能,如果需要请联系OneOaaS")},setSyncPolicy:function(e){t.warning("蓝鲸社区版暂不支持该功能,如果需要请联系OneOaaS")},showAccountDetail:function(e){var t=VCenterConfig.accountTable.rows().data();account_detail_vue.vcenterAccountData=t[e],account_detail_vue.showDetailSide()}}}($,window.toastr),account_detail_vue=new Vue({el:"#vcenterDetails",data:{vcenterAccountData:{},passwordShow:!1},methods:{showDetailSide:function(){$("#vcenterDetailsShade").removeClass("hidden"),$("#vcenterDetails").removeClass("animated fadeOutRight")}},created:function(){$("#close").on("click",function(e){$("#vcenterDetails").addClass("animated fadeOutRight"),setTimeout(function(){$("#vcenterDetailsShade").addClass("hidden")},500)})}}),account_info_vue=new Vue({el:"#vcenter_config",data:{vcenterIsShow:!0,qcloudIsShow:!1,ucloudIsShow:!1,cloudProviderSelected:"",vcenterVersionList:[{id:5,text:"5.0"},{id:5.1,text:"5.1"},{id:5.5,text:"5.5"},{id:6,text:"6.0"}],ucloudRegionList:[{id:"cn-bj1",text:"北京一"},{id:"cn-bj2",text:"北京二"},{id:"cn-zj",text:"浙江"},{id:"cn-sh1",text:"上海一"},{id:"cn-sh2",text:"上海二"},{id:"cn-gd",text:"广州"},{id:"hk",text:"香港"},{id:"us-ca",text:"洛杉矶"},{id:"us-ws",text:"华盛顿"},{id:"ge-fra",text:"法兰克福"},{id:"th-bkk",text:"曼谷"},{id:"kr-seoul",text:"首尔"},{id:"sg",text:"新加坡"},{id:"tw-kh",text:"台湾"}]},methods:{onSubmit:function(e){e.preventDefault()},watchProviderSelected:function(e,t){console.log("newVersion："),console.log(e),console.log("oldVersion："),console.log(t)}},created:function(){$("#vcenter_version .select2_box").select2({placeholder:"请选择VCenter版本",allowClear:!0,data:this.vcenterVersionList}),$("#ucloud_region .select2_box").select2({placeholder:"请选择区域",allowClear:!0,data:this.ucloudRegionList}),VCenterConfig.init()},watch:{cloudProviderSelected:{handler:"watchProviderSelected",deep:!0}}});$(document).ready(function(){$("#vmware_form").validate({errorElement:"div",errorClass:"text-danger",rules:{vcenter_account_name:{required:!0,minlength:2},vcenter_account_password:{required:!0,minlength:6,equalTo:"#vcenter_account_password"},vcenter_host:{required:!0},vcenter_port:{required:!0,minlength:2}},messages:{vcenter_account_name:"请输入Venter账号名称(至少两位)",vcenter_account_password:"请输入VCenter账号密码",vcenter_host:"请输入VCenter主机IP",vcenter_port:"请输入VCenter主机Port"}}),$("#qcloud_form").validate({errorElement:"div",errorClass:"text-danger",rules:{qcloud_account_name:{required:!0,minlength:2},qcloud_secret_id:{required:!0,minlength:2},qcloud_secret_key:{required:!0,minlength:2}},messages:{qcloud_account_name:"请输入腾讯云账号名称(至少两位)",qcloud_secret_id:"请输入SecretId",qcloud_secret_key:"请输入SecretKey"}}),$("#ucloud_form").validate({errorElement:"div",errorClass:"text-danger",rules:{ucloud_account_name:{required:!0,minlength:2},ucloud_public_key:{required:!0,minlength:2},ucloud_private_key:{required:!0,minlength:2},ucloud_project_id:{required:!0,minlength:2}},messages:{ucloud_account_name:"请输入Ucloud账号名称(至少两位)",ucloud_public_key:"请输入PublicKey",ucloud_private_key:"请输入PrivateKey",ucloud_project_id:"请输入项目ID"}})});