function open_host_side(){var e=$("#host_side");e.removeClass("hidden"),getComputedStyle(document.querySelector("body")).display,e.find("#close").addClass("open"),e.find(".shield-edit").addClass("open"),e.find("#shield-detail").removeClass("hidden"),$("article.shield-content").css("overflow","hidden")}function close_host_side(){var e=$("#host_side");e.find(".shield-edit").removeClass("open").children("#shield-detail").addClass("hidden"),e.find("#close").removeClass("open"),setTimeout(function(){e.addClass("hidden"),$("article.shield-content").css("overflow","auto")},300)}function make_single_graphs(){make_contain_graph($("#cpu_usage_maximum"),"cpu.usage.maximum","CPU最大利用率"),make_contain_graph($("#cpu_usage_minimum"),"cpu.usage.minimum","CPU最小利用率"),make_contain_graph($("#mem_usage_minimum"),"mem.usage.minimum","内存最小利用率"),make_contain_graph($("#mem_usage_maximum"),"mem.usage.maximum","内存最大利用率"),make_contain_graph($("#disk_usage_maximum"),"disk.usage.maximum","磁盘最大利用率"),make_contain_graph($("#disk_usage_minimum"),"disk.usage.minimum","磁盘最小利用率"),make_contain_graph($("#net_usage_maximum"),"net.usage.minimum","网络流量最小利用率"),make_contain_graph($("#net_usage_maximum"),"net.usage.maximum","网络流量最大利用率")}function make_contain_graph(e,t,a){var i=e.find(".line-chart"),n=i.attr("data-host_id");n||(n=hosts_view.checked_host_index_table.id);var s={hostId:n,hostName:hosts_view.checked_host_index_table.name,metricName:t,intervalId:86400,maxSample:86400,startTime:"",endTime:""};i.html('<img class="graph-loading" alt="loadding" src="'+static_url+'img/hourglass_36.gif" style="margin-top: 75px;margin-left:45%;">'),$.get(site_url+"vmware/api/getHostMonitorInfos",s,function(e){i.html("");var t={series:[],x_axis:{minRange:1e3,type:"datetime"},chart_type:"spline",unit:"%"};if(e.result){for(var n=e.content.data,s=[],o={},m=[],d=0;d<n.length;d++){s[d]=moment(n[d].unix_time).format("YYYY-MM-DD HH:mm:ss");var l=[];o[n[d].unix_time]=n[d].value,l[0]=1e3*n[d].unix_time,l[1]=n[d].value,m[d]=l}var _={x_axis_list:s,data:m,name:a,type:"spline"};t.series[0]=_,Hchart.spline(t,i[0],o)}else{e.message;i.html(e.message)}},"json")}var UcloudManage=function(e,t){return{vmTable:null,selectedRows:[],init:function(t){var a={search:"搜索：",lengthMenu:"每页显示 _MENU_ 记录",zeroRecords:"没找到相应的数据！",info:"分页 _PAGE_ / _PAGES_",infoEmpty:"暂无数据！",infoFiltered:"(从 _MAX_ 条数据中搜索)",paginate:{first:"<<",last:">>",previous:"上一页",next:"下一页"}},i=e(t).DataTable({paging:!0,ordering:!1,info:!1,searching:!1,pageLength:5,lengthChange:!1,language:a,ajax:{url:site_url+"ucloud/api/getUcloudInstanceList"},columns:[{data:"osType",title:"操作系统类型"},{data:"memory",title:"内存"},{data:"cpu",title:"CPU"},{data:"state",title:"状态"},{data:"isExpire",title:"是否过期"},{data:"chargeType",title:"计费类型"},{data:"expireTime",title:"过期时间"}]});return this.vmTable=i,new e.fn.dataTable.Buttons(i,{buttons:[{extend:"copyHtml5",text:"拷贝表格"},{extend:"excelHtml5",text:"导出Excel"},{extend:"pdfHtml5",text:"导出PDF"},{extend:"csvHtml5",bom:"utf-8",text:"导出CSV"}]}),i.buttons().container().appendTo(i.table().container()),i}}}($,window.toastr),hosts_view=new Vue({el:"#host_side",data:{checked_host_index_table:{}},created:function(){},methods:{},watch:{"checked_host_index_table.length":{handler:function(e,t){""!==this.checked_host_index_table.name&&make_single_graphs()},deep:!0}}});$(document).ready(function(){UcloudManage.init("#ucloud_manage_record"),$("#host_manage_record").on("click","tr:gt(0)",function(){var e=UcloudManage.vmTable.row(this).data();hosts_view.checked_host_index_table=e,open_host_side()}),$("#host_side").find("#cancel").click(function(){close_host_side()}),$("#close, #sideContent").on("click",function(e){"close"==$(e.target).attr("data-type")&&close_host_side()})});